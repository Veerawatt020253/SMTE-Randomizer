<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SMTE Yupparaj Randomizer</title>
    <link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@600&family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --bg-gradient: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            --card-bg: #ffffff;
            --text-main: #2c3e50;
            --text-secondary: #7f8c8d;
            --accent: #0440ff; 
            --accent-glow: rgba(4, 64, 255, 0.4);
            --border: #e0e0e0;
            --shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        body {
            font-family: 'Kanit', sans-serif;
            background: var(--bg-gradient);
            color: var(--text-main);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .brand-header {
            margin-bottom: 25px;
            width: 100%;
            max-width: 450px;
            text-align: center;
            animation: fadeInDown 0.8s ease-out;
        }

        .brand-logo {
            width: 100%;
            height: auto;
            display: block;
        }

        /* === Main Container === */
        .container {
            background: var(--card-bg);
            padding: 40px;
            border-radius: 24px;
            box-shadow: var(--shadow);
            width: 100%;
            max-width: 500px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.5);
            /* เพิ่มขอบบนสีแบรนด์ */
            border-top: 5px solid var(--accent);
            animation: fadeInUp 0.8s ease-out;
        }

        h1 {
            font-weight: 700;
            margin-bottom: 25px;
            font-size: 1.6rem;
            letter-spacing: 0.5px;
            color: var(--text-main);
            text-transform: uppercase;
        }

        h1 i {
            color: var(--accent);
            margin-right: 8px;
        }

        /* Settings Area */
        .settings {
            margin-bottom: 35px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .input-group label {
            display: block;
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 8px;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        input[type="number"] {
            padding: 12px 15px;
            border: 2px solid var(--border);
            border-radius: 12px;
            font-family: 'Kanit', sans-serif;
            font-size: 1.2rem;
            font-weight: 600;
            width: 120px;
            outline: none;
            text-align: center;
            transition: all 0.3s;
            background: #f9f9f9;
        }

        input[type="number"]:focus {
            border-color: var(--accent);
            background: #fff;
            box-shadow: 0 0 0 4px rgba(4, 64, 255, 0.1);
        }

        /* Slot Machine Area - Digital Look */
        .slot-machine {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 40px;
            padding: 25px;
            background: #f0f4f8;
            border-radius: 20px;
            border: 1px solid #dce4ec;
            box-shadow: inset 0 4px 10px rgba(0,0,0,0.05);
        }

        .reel {
            width: 80px;
            height: 110px;
            background: #ffffff;
            border: 2px solid #eef2f7;
            border-radius: 16px;
            display: flex;
            justify-content: center;
            align-items: center;
            /* ใช้ฟอนต์แนว Digital */
            font-family: 'Chakra Petch', sans-serif;
            font-size: 4rem;
            font-weight: 600;
            box-shadow: inset 0 5px 15px rgba(0,0,0,0.1);
            overflow: hidden;
            position: relative;
            color: var(--accent);
            /* เพิ่ม Effect แสงเรืองให้ตัวเลข */
            text-shadow: 0 0 15px var(--accent-glow);
        }

        .reel span {
            display: block;
            line-height: 1;
        }

        .reel.spinning span {
            animation: blurText 0.1s infinite;
        }

        @keyframes blurText {
            0% { filter: blur(0px); transform: translateY(0); opacity: 1; }
            50% { filter: blur(5px); transform: translateY(-10px); opacity: 0.7; }
            100% { filter: blur(0px); transform: translateY(10px); opacity: 1; }
        }

        /* Controls */
        .controls {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-bottom: 30px;
        }

        button {
            border: none;
            padding: 14px 28px;
            border-radius: 50px;
            font-family: 'Kanit', sans-serif;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        button:active {
            transform: scale(0.95);
        }

        .btn-spin {
            background: linear-gradient(135deg, var(--accent) 0%, #0330c4 100%);
            color: white;
            padding: 14px 50px;
            box-shadow: 0 10px 20px rgba(4, 64, 255, 0.3);
        }

        .btn-spin:hover {
            box-shadow: 0 15px 30px rgba(4, 64, 255, 0.4);
            transform: translateY(-2px);
        }

        .btn-reset {
            background-color: white;
            border: 2px solid var(--border);
            color: var(--text-secondary);
        }

        .btn-reset:hover {
            border-color: var(--accent);
            color: var(--accent);
            background: #f8f9ff;
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
            box-shadow: none !important;
        }

        /* History */
        .history-section {
            border-top: 2px dashed var(--border);
            padding-top: 25px;
        }

        .history-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            font-size: 0.95rem;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
        }

        .history-list {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
            max-height: 150px;
            overflow-y: auto;
            padding: 5px; /* เพิ่ม padding กันตกขอบ */
        }

        /* Custom Scrollbar for history */
        .history-list::-webkit-scrollbar {
            width: 6px;
        }
        .history-list::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        .history-list::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 10px;
        }
        .history-list::-webkit-scrollbar-thumb:hover {
            background: var(--accent);
        }


        .history-item {
            background: white;
            border: 2px solid var(--accent);
            color: var(--accent);
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 1rem;
            font-family: 'Chakra Petch', sans-serif; /* ใช้ฟอนต์ Digital กับประวัติด้วย */
            font-weight: 600;
            animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); /* เด้งดึ๋ง */
            box-shadow: 0 4px 6px rgba(4, 64, 255, 0.1);
        }

        @keyframes popIn {
            0% { transform: scale(0.5); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }

        .message {
            margin-top: 15px;
            font-size: 0.95rem;
            font-weight: 600;
            height: 25px;
            color: #e74c3c;
        }

        /* Animations for page load */
        @keyframes fadeInDown {
            from { opacity: 0; transform: translate3d(0, -20px, 0); }
            to { opacity: 1; transform: translate3d(0, 0, 0); }
        }
        @keyframes fadeInUp {
            from { opacity: 0; transform: translate3d(0, 20px, 0); }
            to { opacity: 1; transform: translate3d(0, 0, 0); }
        }

    </style>
</head>
<body>

    <div class="brand-header">
        <img src="./logo.png" alt="SMTE Yupparaj Logo" class="brand-logo">
    </div>

    <div class="container">
        <h1>SMTE Randomizer</h1>

        <div class="settings">
            <div class="input-group">
                <label for="maxNumber">จำนวนสูงสุด (Max 999)</label>
                <input type="number" id="maxNumber" value="100" min="1" max="999">
            </div>
        </div>

        <div class="slot-machine">
            <div class="reel"><span id="reel1">0</span></div>
            <div class="reel"><span id="reel2">0</span></div>
            <div class="reel"><span id="reel3">0</span></div>
        </div>

        <div id="message" class="message"></div>

        <div class="controls">
            <button class="btn-reset" onclick="resetGame()">
                <i class="fa-solid fa-rotate-right"></i> เริ่มใหม่
            </button>
            <button class="btn-spin" onclick="spin()" id="spinBtn">
                <i class="fa-solid fa-play"></i> START RANDOM
            </button>
        </div>

        <div class="history-section">
            <div class="history-header">
                <span><i class="fa-solid fa-list-ol"></i> ประวัติการสุ่ม (<span id="count">0</span>)</span>
            </div>
            <div class="history-list" id="historyList">
                </div>
        </div>
    </div>

    <script>
        let generatedNumbers = new Set();
        let isSpinning = false;
        
        // Configuration
        const spinDuration = 3000; // เพิ่มเวลาหมุนอีกนิดให้ดูขลังขึ้น
        const reelDelays = [0, 1000, 2000]; // Delay for each reel stopping

        const reel1 = document.getElementById('reel1');
        const reel2 = document.getElementById('reel2');
        const reel3 = document.getElementById('reel3');
        const spinBtn = document.getElementById('spinBtn');
        const messageEl = document.getElementById('message');
        const historyList = document.getElementById('historyList');
        const countEl = document.getElementById('count');
        const maxInput = document.getElementById('maxNumber');

        function getRandomInt(max) {
            return Math.floor(Math.random() * (max + 1));
        }

        function pad(num) {
            return num.toString().padStart(3, '0');
        }

        // Animation Helper
        function animateReel(element, duration, stopValue) {
            const intervalTime = 50;
            let counter = 0;
            
            element.parentElement.classList.add('spinning');

            // ใช้ตัวเลขสุ่มแบบเร็วๆ ระหว่างหมุน
            const interval = setInterval(() => {
                element.innerText = Math.floor(Math.random() * 10);
            }, intervalTime);

            setTimeout(() => {
                clearInterval(interval);
                element.innerText = stopValue;
                element.parentElement.classList.remove('spinning');
                // เพิ่ม effect กระพริบเล็กน้อยเมื่อหยุด
                element.style.textShadow = "0 0 30px var(--accent), 0 0 50px var(--accent)";
                setTimeout(() => {
                     element.style.textShadow = "";
                }, 300);

            }, duration);
        }

        function spin() {
            if (isSpinning) return;
            
            let maxVal = parseInt(maxInput.value);
            if (isNaN(maxVal) || maxVal < 0) maxVal = 999;
            if (maxVal > 999) maxVal = 999;
            maxInput.value = maxVal; 

            // Check if full
            if (generatedNumbers.size > maxVal) {
                messageEl.innerText = "ครบตามจำนวนที่กำหนดแล้ว! กรุณากดเริ่มใหม่";
                messageEl.style.color = "#e74c3c";
                return;
            }

            messageEl.innerText = "กำลังประมวลผล...";
            messageEl.style.color = "var(--accent)";
            isSpinning = true;
            spinBtn.disabled = true;
            maxInput.disabled = true;
            spinBtn.innerHTML = '<i class="fa-solid fa-spinner fa-spin"></i> RUNNING...';

            // Generate Unique Number logic
            let result;
            do {
                result = getRandomInt(maxVal);
            } while (generatedNumbers.has(result));

            generatedNumbers.add(result);
            
            const resultStr = pad(result);
            const digit1 = resultStr[0];
            const digit2 = resultStr[1];
            const digit3 = resultStr[2];

            // Trigger Animations
            animateReel(reel1, spinDuration + reelDelays[0], digit1);
            animateReel(reel2, spinDuration + reelDelays[1], digit2);
            animateReel(reel3, spinDuration + reelDelays[2], digit3);

            // Finish
            setTimeout(() => {
                addToHistory(resultStr);
                isSpinning = false;
                spinBtn.disabled = false;
                spinBtn.innerHTML = '<i class="fa-solid fa-play"></i> START RANDOM';
                messageEl.innerText = "";
                
                if (generatedNumbers.size > maxVal) {
                     messageEl.innerText = "ครบกำหนดแล้ว";
                    spinBtn.disabled = true;
                }

            }, spinDuration + reelDelays[2] + 400);
        }

        function addToHistory(numStr) {
            const item = document.createElement('div');
            item.className = 'history-item';
            item.innerText = numStr;
            historyList.insertBefore(item, historyList.firstChild);
            countEl.innerText = generatedNumbers.size;
        }

        function resetGame() {
            if (isSpinning) return;
            if(!confirm("ยืนยันการล้างข้อมูลประวัติทั้งหมด?")) return;

            generatedNumbers.clear();
            historyList.innerHTML = '';
            countEl.innerText = '0';
            messageEl.innerText = '';
            maxInput.disabled = false;
            spinBtn.disabled = false;
            
            reel1.innerText = '0';
            reel2.innerText = '0';
            reel3.innerText = '0';
        }
    </script>
</body>
</html>